package fndsa

import (
	"math/bits"
)

// For FFT and other computations with approximations, we use a fixed-point
// format over 64 bits; the top 32 bits are the integral part, and the low
// 32 bits are the fractional part.

type fxr = uint64

const fxr_ZERO = fxr(0)
const fxr_ONE = fxr(uint64(1) << 32)

// Convert an integer to fxr.
func fxr_of(j int32) fxr {
	return uint64(j) << 32
}

// Given t, return t/2^32.
func fxr_of_scaled32(t uint64) fxr {
	return t
}

// Addition.
func fxr_add(x fxr, y fxr) fxr {
	return x + y
}

// Subtraction.
func fxr_sub(x fxr, y fxr) fxr {
	return x - y
}

// Doubling.
func fxr_double(x fxr) fxr {
	return x << 1
}

// Negation.
func fxr_neg(x fxr) fxr {
	return -x
}

// Absolute value.
func fxr_abs(x fxr) fxr {
	m := uint64(int64(x) >> 63)
	return (x ^ m) - m
}

// Multiplication.
func fxr_mul(x fxr, y fxr) fxr {
	// We need a _signed_ 64x64->128 multiplication, but the standard
	// library only provides an unsigned version of that primitive, so
	// we must fiddle with signs. If we note sx and sy the signs of x
	// and y, respectively (0 for non-negative, 1 for negative), then
	// the unsigned multiplication computes:
	//    (x + sx*2^64)*(y + sy*s^64) = x*y + (sx*y + sy*x)*2^64  mod 2^128
	// Thus, we need to conditionally subtract x and/or y from the high word,
	// depending on the signs.
	hi, lo := bits.Mul64(x, y)
	sx := uint64(int64(x) >> 63)
	sy := uint64(int64(y) >> 63)
	hi -= (x & sy) + (y & sx)
	return (hi << 32) | (lo >> 32)
}

// Squaring.
func fxr_sqr(x fxr) fxr {
	// We can replace x with its absolute value, thus allowing the
	// unsigned multiplication to return the correct value.
	x = fxr_abs(x)
	hi, lo := bits.Mul64(x, x)
	return (hi << 32) | (lo >> 32)
}

// Rounding.
func fxr_round(x fxr) int32 {
	x += 0x80000000
	return int32(x >> 32)
}

// Divide by 2^e.
func fxr_div2e(x fxr, e uint32) fxr {
	x += (uint64(1) << e) >> 1
	return fxr(int64(x) >> e)
}

// Multiply by 2^e.
func fxr_mul2e(x fxr, e uint32) fxr {
	return x << e
}

// Division.
func fxr_div(x fxr, y fxr) fxr {
	// Get absolute values and signs. From now on, we can suppose
	// that x and y fit on 63 bits (we ignore edge conditions).
	sx := x >> 63
	x = (x ^ -sx) + sx
	sy := y >> 63
	y = (y ^ -sy) + sy

	// Do a bit by bit division, assuming that the quotient fits.
	// The numerator starts at x*2^31, and is shifted one bit a time.
	q := uint64(0)
	num := x >> 31
	for i := 63; i >= 33; i-- {
		b := uint64(1) - ((num - y) >> 63)
		q |= b << i
		num -= y & -b
		num <<= 1
		num |= (x >> (i - 33)) & 1
	}
	for i := 32; i >= 0; i-- {
		b := uint64(1) - ((num - y) >> 63)
		q |= b << i
		num -= y & -b
		num <<= 1
	}

	// Rounding: if the remainder is at least y/2 (scaled), we add
	// 2^(-32) to the quotient.
	b := uint64(1) - ((num - y) >> 63)
	q += b

	// Sign management: if the original x and y had different signs,
	// then we must negate the quotient.
	sx ^= sy
	q = (q ^ -sx) + sx

	return q
}

// Inversion.
func fxr_inv(x fxr) fxr {
	return fxr_div(fxr_ONE, x)
}

// Comparison (lower-than).
func fxr_lt(x fxr, y fxr) bool {
	return int64(x) < int64(y)
}

// Complex addition.
func fxc_add(a_re fxr, a_im fxr, b_re fxr, b_im fxr) (fxr, fxr) {
	return fxr_add(a_re, b_re), fxr_add(a_im, b_im)
}

// Complex subtraction.
func fxc_sub(a_re fxr, a_im fxr, b_re fxr, b_im fxr) (fxr, fxr) {
	return fxr_sub(a_re, b_re), fxr_sub(a_im, b_im)
}

// Complex halving.
func fxc_half(a_re fxr, a_im fxr) (fxr, fxr) {
	return fxr_div2e(a_re, 1), fxr_div2e(a_im, 1)
}

// Complex multiplication.
func fxc_mul(x_re fxr, x_im fxr, y_re fxr, y_im fxr) (fxr, fxr) {
	// We are computing r = (a + i*b)*(c + i*d) with:
	//   z0 = a*c
	//   z1 = b*d
	//   z2 = (a + b)*(c + d)
	//   r = (z0 - z1) + i*(z2 - (z0 + z1))
	// Due to the approximate nature of fxr, this might not yield
	// exactly the same imaginary value as a*d + b*c would.
	z0 := fxr_mul(x_re, y_re)
	z1 := fxr_mul(x_im, y_im)
	z2 := fxr_mul(fxr_add(x_re, x_im), fxr_add(y_re, y_im))
	return fxr_sub(z0, z1), fxr_sub(z2, fxr_add(z0, z1))
}

// Primitive 2048-th roots of unity, in the proper of FFT. In the table,
// real and imaginary parts of each root is provided as two consecutive
// values.
var gm_tab = []fxr{
	fxr(4294967296), fxr(0),
	fxr(0), fxr(4294967296),
	fxr(3037000500), fxr(3037000500),
	fxr(18446744070672551116), fxr(3037000500),
	fxr(3968032378), fxr(1643612827),
	fxr(18446744072065938789), fxr(3968032378),
	fxr(1643612827), fxr(3968032378),
	fxr(18446744069741519238), fxr(1643612827),
	fxr(4212440704), fxr(837906553),
	fxr(18446744072871645063), fxr(4212440704),
	fxr(2386155981), fxr(3571134792),
	fxr(18446744070138416824), fxr(2386155981),
	fxr(3571134792), fxr(2386155981),
	fxr(18446744071323395635), fxr(3571134792),
	fxr(837906553), fxr(4212440704),
	fxr(18446744069497110912), fxr(837906553),
	fxr(4274285855), fxr(420980412),
	fxr(18446744073288571204), fxr(4274285855),
	fxr(2724698408), fxr(3320054617),
	fxr(18446744070389496999), fxr(2724698408),
	fxr(3787822988), fxr(2024633568),
	fxr(18446744071684918048), fxr(3787822988),
	fxr(1246763195), fxr(4110027446),
	fxr(18446744069599524170), fxr(1246763195),
	fxr(4110027446), fxr(1246763195),
	fxr(18446744072462788421), fxr(4110027446),
	fxr(2024633568), fxr(3787822988),
	fxr(18446744069921728628), fxr(2024633568),
	fxr(3320054617), fxr(2724698408),
	fxr(18446744070984853208), fxr(3320054617),
	fxr(420980412), fxr(4274285855),
	fxr(18446744069435265761), fxr(420980412),
	fxr(4289793820), fxr(210744057),
	fxr(18446744073498807559), fxr(4289793820),
	fxr(2884323748), fxr(3182360851),
	fxr(18446744070527190765), fxr(2884323748),
	fxr(3882604450), fxr(1836335144),
	fxr(18446744071873216472), fxr(3882604450),
	fxr(1446930903), fxr(4043900968),
	fxr(18446744069665650648), fxr(1446930903),
	fxr(4166252509), fxr(1043591926),
	fxr(18446744072665959690), fxr(4166252509),
	fxr(2208054473), fxr(3683916329),
	fxr(18446744070025635287), fxr(2208054473),
	fxr(3449750080), fxr(2558509031),
	fxr(18446744071151042585), fxr(3449750080),
	fxr(630202589), fxr(4248480760),
	fxr(18446744069461070856), fxr(630202589),
	fxr(4248480760), fxr(630202589),
	fxr(18446744073079349027), fxr(4248480760),
	fxr(2558509031), fxr(3449750080),
	fxr(18446744070259801536), fxr(2558509031),
	fxr(3683916329), fxr(2208054473),
	fxr(18446744071501497143), fxr(3683916329),
	fxr(1043591926), fxr(4166252509),
	fxr(18446744069543299107), fxr(1043591926),
	fxr(4043900968), fxr(1446930903),
	fxr(18446744072262620713), fxr(4043900968),
	fxr(1836335144), fxr(3882604450),
	fxr(18446744069826947166), fxr(1836335144),
	fxr(3182360851), fxr(2884323748),
	fxr(18446744070825227868), fxr(3182360851),
	fxr(210744057), fxr(4289793820),
	fxr(18446744069419757796), fxr(210744057),
	fxr(4293673732), fxr(105403774),
	fxr(18446744073604147842), fxr(4293673732),
	fxr(2961554089), fxr(3110617535),
	fxr(18446744070598934081), fxr(2961554089),
	fxr(3926501002), fxr(1740498191),
	fxr(18446744071969053425), fxr(3926501002),
	fxr(1545737412), fxr(4007173558),
	fxr(18446744069702378058), fxr(1545737412),
	fxr(4190608739), fxr(941032661),
	fxr(18446744072768518955), fxr(4190608739),
	fxr(2297797281), fxr(3628618433),
	fxr(18446744070080933183), fxr(2297797281),
	fxr(3511500034), fxr(2473077351),
	fxr(18446744071236474265), fxr(3511500034),
	fxr(734275721), fxr(4231735252),
	fxr(18446744069477816364), fxr(734275721),
	fxr(4262667143), fxr(525749847),
	fxr(18446744073183801769), fxr(4262667143),
	fxr(2642399561), fxr(3385922125),
	fxr(18446744070323629491), fxr(2642399561),
	fxr(3736995171), fxr(2116981616),
	fxr(18446744071592570000), fxr(3736995171),
	fxr(1145522571), fxr(4139386683),
	fxr(18446744069570164933), fxr(1145522571),
	fxr(4078192482), fxr(1347252816),
	fxr(18446744072362298800), fxr(4078192482),
	fxr(1931065957), fxr(3836369162),
	fxr(18446744069873182454), fxr(1931065957),
	fxr(3252187232), fxr(2805355999),
	fxr(18446744070904195617), fxr(3252187232),
	fxr(315957395), fxr(4283329896),
	fxr(18446744069426221720), fxr(315957395),
	fxr(4283329896), fxr(315957395),
	fxr(18446744073393594221), fxr(4283329896),
	fxr(2805355999), fxr(3252187232),
	fxr(18446744070457364384), fxr(2805355999),
	fxr(3836369162), fxr(1931065957),
	fxr(18446744071778485659), fxr(3836369162),
	fxr(1347252816), fxr(4078192482),
	fxr(18446744069631359134), fxr(1347252816),
	fxr(4139386683), fxr(1145522571),
	fxr(18446744072564029045), fxr(4139386683),
	fxr(2116981616), fxr(3736995171),
	fxr(18446744069972556445), fxr(2116981616),
	fxr(3385922125), fxr(2642399561),
	fxr(18446744071067152055), fxr(3385922125),
	fxr(525749847), fxr(4262667143),
	fxr(18446744069446884473), fxr(525749847),
	fxr(4231735252), fxr(734275721),
	fxr(18446744072975275895), fxr(4231735252),
	fxr(2473077351), fxr(3511500034),
	fxr(18446744070198051582), fxr(2473077351),
	fxr(3628618433), fxr(2297797281),
	fxr(18446744071411754335), fxr(3628618433),
	fxr(941032661), fxr(4190608739),
	fxr(18446744069518942877), fxr(941032661),
	fxr(4007173558), fxr(1545737412),
	fxr(18446744072163814204), fxr(4007173558),
	fxr(1740498191), fxr(3926501002),
	fxr(18446744069783050614), fxr(1740498191),
	fxr(3110617535), fxr(2961554089),
	fxr(18446744070747997527), fxr(3110617535),
	fxr(105403774), fxr(4293673732),
	fxr(18446744069415877884), fxr(105403774),
	fxr(4294643893), fxr(52705856),
	fxr(18446744073656845760), fxr(4294643893),
	fxr(2999503152), fxr(3074040487),
	fxr(18446744070635511129), fxr(2999503152),
	fxr(3947563934), fxr(1692182927),
	fxr(18446744072017368689), fxr(3947563934),
	fxr(1594795204), fxr(3987903250),
	fxr(18446744069721648366), fxr(1594795204),
	fxr(4201841112), fxr(889536587),
	fxr(18446744072820015029), fxr(4201841112),
	fxr(2342152991), fxr(3600147697),
	fxr(18446744070109403919), fxr(2342152991),
	fxr(3541584088), fxr(2429799626),
	fxr(18446744071279751990), fxr(3541584088),
	fxr(786150333), fxr(4222405917),
	fxr(18446744069487145699), fxr(786150333),
	fxr(4268797931), fxr(473400776),
	fxr(18446744073236150840), fxr(4268797931),
	fxr(2683751066), fxr(3353240863),
	fxr(18446744070356310753), fxr(2683751066),
	fxr(3762692404), fxr(2070963532),
	fxr(18446744071638588084), fxr(3762692404),
	fxr(1196232957), fxr(4125017671),
	fxr(18446744069584533945), fxr(1196232957),
	fxr(4094418266), fxr(1297105676),
	fxr(18446744072412445940), fxr(4094418266),
	fxr(1977998702), fxr(3812383140),
	fxr(18446744069897168476), fxr(1977998702),
	fxr(3286368382), fxr(2765235421),
	fxr(18446744070944316195), fxr(3286368382),
	fxr(368496651), fxr(4279130086),
	fxr(18446744069430421530), fxr(368496651),
	fxr(4286884652), fxr(263370557),
	fxr(18446744073446181059), fxr(4286884652),
	fxr(2845054101), fxr(3217516315),
	fxr(18446744070492035301), fxr(2845054101),
	fxr(3859777440), fxr(1883842400),
	fxr(18446744071825709216), fxr(3859777440),
	fxr(1397197066), fxr(4061352537),
	fxr(18446744069648199079), fxr(1397197066),
	fxr(4153132319), fxr(1094639673),
	fxr(18446744072614911943), fxr(4153132319),
	fxr(2162680890), fxr(3710735162),
	fxr(18446744069998816454), fxr(2162680890),
	fxr(3418093478), fxr(2600650120),
	fxr(18446744071108901496), fxr(3418093478),
	fxr(578019742), fxr(4255894413),
	fxr(18446744069453657203), fxr(578019742),
	fxr(4240427302), fxr(682290530),
	fxr(18446744073027261086), fxr(4240427302),
	fxr(2515982640), fxr(3480887161),
	fxr(18446744070228664455), fxr(2515982640),
	fxr(3656542712), fxr(2253095531),
	fxr(18446744071456456085), fxr(3656542712),
	fxr(992387019), fxr(4178745276),
	fxr(18446744069530806340), fxr(992387019),
	fxr(4025840401), fxr(1496446837),
	fxr(18446744072213104779), fxr(4025840401),
	fxr(1788551342), fxr(3904846754),
	fxr(18446744069804704862), fxr(1788551342),
	fxr(3146726136), fxr(2923159027),
	fxr(18446744070786392589), fxr(3146726136),
	fxr(158085819), fxr(4292056960),
	fxr(18446744069417494656), fxr(158085819),
	fxr(4292056960), fxr(158085819),
	fxr(18446744073551465797), fxr(4292056960),
	fxr(2923159027), fxr(3146726136),
	fxr(18446744070562825480), fxr(2923159027),
	fxr(3904846754), fxr(1788551342),
	fxr(18446744071921000274), fxr(3904846754),
	fxr(1496446837), fxr(4025840401),
	fxr(18446744069683711215), fxr(1496446837),
	fxr(4178745276), fxr(992387019),
	fxr(18446744072717164597), fxr(4178745276),
	fxr(2253095531), fxr(3656542712),
	fxr(18446744070053008904), fxr(2253095531),
	fxr(3480887161), fxr(2515982640),
	fxr(18446744071193568976), fxr(3480887161),
	fxr(682290530), fxr(4240427302),
	fxr(18446744069469124314), fxr(682290530),
	fxr(4255894413), fxr(578019742),
	fxr(18446744073131531874), fxr(4255894413),
	fxr(2600650120), fxr(3418093478),
	fxr(18446744070291458138), fxr(2600650120),
	fxr(3710735162), fxr(2162680890),
	fxr(18446744071546870726), fxr(3710735162),
	fxr(1094639673), fxr(4153132319),
	fxr(18446744069556419297), fxr(1094639673),
	fxr(4061352537), fxr(1397197066),
	fxr(18446744072312354550), fxr(4061352537),
	fxr(1883842400), fxr(3859777440),
	fxr(18446744069849774176), fxr(1883842400),
	fxr(3217516315), fxr(2845054101),
	fxr(18446744070864497515), fxr(3217516315),
	fxr(263370557), fxr(4286884652),
	fxr(18446744069422666964), fxr(263370557),
	fxr(4279130086), fxr(368496651),
	fxr(18446744073341054965), fxr(4279130086),
	fxr(2765235421), fxr(3286368382),
	fxr(18446744070423183234), fxr(2765235421),
	fxr(3812383140), fxr(1977998702),
	fxr(18446744071731552914), fxr(3812383140),
	fxr(1297105676), fxr(4094418266),
	fxr(18446744069615133350), fxr(1297105676),
	fxr(4125017671), fxr(1196232957),
	fxr(18446744072513318659), fxr(4125017671),
	fxr(2070963532), fxr(3762692404),
	fxr(18446744069946859212), fxr(2070963532),
	fxr(3353240863), fxr(2683751066),
	fxr(18446744071025800550), fxr(3353240863),
	fxr(473400776), fxr(4268797931),
	fxr(18446744069440753685), fxr(473400776),
	fxr(4222405917), fxr(786150333),
	fxr(18446744072923401283), fxr(4222405917),
	fxr(2429799626), fxr(3541584088),
	fxr(18446744070167967528), fxr(2429799626),
	fxr(3600147697), fxr(2342152991),
	fxr(18446744071367398625), fxr(3600147697),
	fxr(889536587), fxr(4201841112),
	fxr(18446744069507710504), fxr(889536587),
	fxr(3987903250), fxr(1594795204),
	fxr(18446744072114756412), fxr(3987903250),
	fxr(1692182927), fxr(3947563934),
	fxr(18446744069761987682), fxr(1692182927),
	fxr(3074040487), fxr(2999503152),
	fxr(18446744070710048464), fxr(3074040487),
	fxr(52705856), fxr(4294643893),
	fxr(18446744069414907723), fxr(52705856),
	fxr(4294886444), fxr(26353424),
	fxr(18446744073683198192), fxr(4294886444),
	fxr(3018308645), fxr(3055578014),
	fxr(18446744070653973602), fxr(3018308645),
	fxr(3957872662), fxr(1667929275),
	fxr(18446744072041622341), fxr(3957872662),
	fxr(1619234497), fxr(3978042699),
	fxr(18446744069731508917), fxr(1619234497),
	fxr(4207220108), fxr(863737830),
	fxr(18446744072845813786), fxr(4207220108),
	fxr(2364198992), fxr(3585708745),
	fxr(18446744070123842871), fxr(2364198992),
	fxr(3556426389), fxr(2408023134),
	fxr(18446744071301528482), fxr(3556426389),
	fxr(812043729), fxr(4217502704),
	fxr(18446744069492048912), fxr(812043729),
	fxr(4271622305), fxr(447199012),
	fxr(18446744073262352604), fxr(4271622305),
	fxr(2704275644), fxr(3336710553),
	fxr(18446744070372841063), fxr(2704275644),
	fxr(3775328765), fxr(2047837100),
	fxr(18446744071661714516), fxr(3775328765),
	fxr(1221521071), fxr(4117600071),
	fxr(18446744069591951545), fxr(1221521071),
	fxr(4102300081), fxr(1271958380),
	fxr(18446744072437593236), fxr(4102300081),
	fxr(2001353810), fxr(3800174601),
	fxr(18446744069909377015), fxr(2001353810),
	fxr(3303273682), fxr(2745018589),
	fxr(18446744070964533027), fxr(3303273682),
	fxr(394745962), fxr(4276788480),
	fxr(18446744069432763136), fxr(394745962),
	fxr(4288419964), fxr(237061769),
	fxr(18446744073472489847), fxr(4288419964),
	fxr(2864742853), fxr(3199998822),
	fxr(18446744070509552794), fxr(2864742853),
	fxr(3871263820), fxr(1860123788),
	fxr(18446744071849427828), fxr(3871263820),
	fxr(1422090755), fxr(4052703044),
	fxr(18446744069656848572), fxr(1422090755),
	fxr(4159770720), fxr(1069135926),
	fxr(18446744072640415690), fxr(4159770720),
	fxr(2185408821), fxr(3697395348),
	fxr(18446744070012156268), fxr(2185408821),
	fxr(3433986423), fxr(2579628136),
	fxr(18446744071129923480), fxr(3433986423),
	fxr(604122538), fxr(4252267634),
	fxr(18446744069457283982), fxr(604122538),
	fxr(4244533933), fxr(656258914),
	fxr(18446744073053292702), fxr(4244533933),
	fxr(2537293599), fxr(3465383855),
	fxr(18446744070244167761), fxr(2537293599),
	fxr(3670298613), fxr(2230616993),
	fxr(18446744071478934623), fxr(3670298613),
	fxr(1018008636), fxr(4172577440),
	fxr(18446744069536974176), fxr(1018008636),
	fxr(4034946641), fxr(1471716574),
	fxr(18446744072237835042), fxr(4034946641),
	fxr(1812477362), fxr(3893798902),
	fxr(18446744069815752714), fxr(1812477362),
	fxr(3164603066), fxr(2903796051),
	fxr(18446744070805755565), fxr(3164603066),
	fxr(184418409), fxr(4291006167),
	fxr(18446744069418545449), fxr(184418409),
	fxr(4292946160), fxr(131747276),
	fxr(18446744073577804340), fxr(4292946160),
	fxr(2942411948), fxr(3128730733),
	fxr(18446744070580820883), fxr(2942411948),
	fxr(3915747591), fxr(1764557983),
	fxr(18446744071944993633), fxr(3915747591),
	fxr(1521120759), fxr(4016582591),
	fxr(18446744069692969025), fxr(1521120759),
	fxr(4184755784), fxr(966728038),
	fxr(18446744072742823578), fxr(4184755784),
	fxr(2275489241), fxr(3642649144),
	fxr(18446744070066902472), fxr(2275489241),
	fxr(3496259414), fxr(2494576955),
	fxr(18446744071214974661), fxr(3496259414),
	fxr(708296459), fxr(4236161021),
	fxr(18446744069473390595), fxr(708296459),
	fxr(4259360959), fxr(551895183),
	fxr(18446744073157656433), fxr(4259360959),
	fxr(2621574191), fxr(3402071844),
	fxr(18446744070307479772), fxr(2621574191),
	fxr(3723935269), fxr(2139871536),
	fxr(18446744071569680080), fxr(3723935269),
	fxr(1120102207), fxr(4146337555),
	fxr(18446744069563214061), fxr(1120102207),
	fxr(4069849124), fxr(1372250773),
	fxr(18446744072337300843), fxr(4069849124),
	fxr(1907490086), fxr(3848145741),
	fxr(18446744069861405875), fxr(1907490086),
	fxr(3234912670), fxr(2825258235),
	fxr(18446744070884293381), fxr(3234912670),
	fxr(289669429), fxr(4285187942),
	fxr(18446744069424363674), fxr(289669429),
	fxr(4281310585), fxr(342233465),
	fxr(18446744073367318151), fxr(4281310585),
	fxr(2785348143), fxr(3269339351),
	fxr(18446744070440212265), fxr(2785348143),
	fxr(3824448145), fxr(1954569124),
	fxr(18446744071754982492), fxr(3824448145),
	fxr(1322204136), fxr(4086382299),
	fxr(18446744069623169317), fxr(1322204136),
	fxr(4132279966), fxr(1170899806),
	fxr(18446744072538651810), fxr(4132279966),
	fxr(2094011993), fxr(3749914379),
	fxr(18446744069959637237), fxr(2094011993),
	fxr(3369644927), fxr(2663125446),
	fxr(18446744071046426170), fxr(3369644927),
	fxr(499584716), fxr(4265812840),
	fxr(18446744069443738776), fxr(499584716),
	fxr(4227150159), fxr(760227338),
	fxr(18446744072949324278), fxr(4227150159),
	fxr(2451484637), fxr(3526608449),
	fxr(18446744070182943167), fxr(2451484637),
	fxr(3614451106), fxr(2320018810),
	fxr(18446744071389532806), fxr(3614451106),
	fxr(915301854), fxr(4196303920),
	fxr(18446744069513247696), fxr(915301854),
	fxr(3997613658), fxr(1570295869),
	fxr(18446744072139255747), fxr(3997613658),
	fxr(1716372869), fxr(3937106583),
	fxr(18446744069772445033), fxr(1716372869),
	fxr(3092387225), fxr(2980584729),
	fxr(18446744070728966887), fxr(3092387225),
	fxr(79056303), fxr(4294239650),
	fxr(18446744069415311966), fxr(79056303),
	fxr(4294239650), fxr(79056303),
	fxr(18446744073630495313), fxr(4294239650),
	fxr(2980584729), fxr(3092387225),
	fxr(18446744070617164391), fxr(2980584729),
	fxr(3937106583), fxr(1716372869),
	fxr(18446744071993178747), fxr(3937106583),
	fxr(1570295869), fxr(3997613658),
	fxr(18446744069711937958), fxr(1570295869),
	fxr(4196303920), fxr(915301854),
	fxr(18446744072794249762), fxr(4196303920),
	fxr(2320018810), fxr(3614451106),
	fxr(18446744070095100510), fxr(2320018810),
	fxr(3526608449), fxr(2451484637),
	fxr(18446744071258066979), fxr(3526608449),
	fxr(760227338), fxr(4227150159),
	fxr(18446744069482401457), fxr(760227338),
	fxr(4265812840), fxr(499584716),
	fxr(18446744073209966900), fxr(4265812840),
	fxr(2663125446), fxr(3369644927),
	fxr(18446744070339906689), fxr(2663125446),
	fxr(3749914379), fxr(2094011993),
	fxr(18446744071615539623), fxr(3749914379),
	fxr(1170899806), fxr(4132279966),
	fxr(18446744069577271650), fxr(1170899806),
	fxr(4086382299), fxr(1322204136),
	fxr(18446744072387347480), fxr(4086382299),
	fxr(1954569124), fxr(3824448145),
	fxr(18446744069885103471), fxr(1954569124),
	fxr(3269339351), fxr(2785348143),
	fxr(18446744070924203473), fxr(3269339351),
	fxr(342233465), fxr(4281310585),
	fxr(18446744069428241031), fxr(342233465),
	fxr(4285187942), fxr(289669429),
	fxr(18446744073419882187), fxr(4285187942),
	fxr(2825258235), fxr(3234912670),
	fxr(18446744070474638946), fxr(2825258235),
	fxr(3848145741), fxr(1907490086),
	fxr(18446744071802061530), fxr(3848145741),
	fxr(1372250773), fxr(4069849124),
	fxr(18446744069639702492), fxr(1372250773),
	fxr(4146337555), fxr(1120102207),
	fxr(18446744072589449409), fxr(4146337555),
	fxr(2139871536), fxr(3723935269),
	fxr(18446744069985616347), fxr(2139871536),
	fxr(3402071844), fxr(2621574191),
	fxr(18446744071087977425), fxr(3402071844),
	fxr(551895183), fxr(4259360959),
	fxr(18446744069450190657), fxr(551895183),
	fxr(4236161021), fxr(708296459),
	fxr(18446744073001255157), fxr(4236161021),
	fxr(2494576955), fxr(3496259414),
	fxr(18446744070213292202), fxr(2494576955),
	fxr(3642649144), fxr(2275489241),
	fxr(18446744071434062375), fxr(3642649144),
	fxr(966728038), fxr(4184755784),
	fxr(18446744069524795832), fxr(966728038),
	fxr(4016582591), fxr(1521120759),
	fxr(18446744072188430857), fxr(4016582591),
	fxr(1764557983), fxr(3915747591),
	fxr(18446744069793804025), fxr(1764557983),
	fxr(3128730733), fxr(2942411948),
	fxr(18446744070767139668), fxr(3128730733),
	fxr(131747276), fxr(4292946160),
	fxr(18446744069416605456), fxr(131747276),
	fxr(4291006167), fxr(184418409),
	fxr(18446744073525133207), fxr(4291006167),
	fxr(2903796051), fxr(3164603066),
	fxr(18446744070544948550), fxr(2903796051),
	fxr(3893798902), fxr(1812477362),
	fxr(18446744071897074254), fxr(3893798902),
	fxr(1471716574), fxr(4034946641),
	fxr(18446744069674604975), fxr(1471716574),
	fxr(4172577440), fxr(1018008636),
	fxr(18446744072691542980), fxr(4172577440),
	fxr(2230616993), fxr(3670298613),
	fxr(18446744070039253003), fxr(2230616993),
	fxr(3465383855), fxr(2537293599),
	fxr(18446744071172258017), fxr(3465383855),
	fxr(656258914), fxr(4244533933),
	fxr(18446744069465017683), fxr(656258914),
	fxr(4252267634), fxr(604122538),
	fxr(18446744073105429078), fxr(4252267634),
	fxr(2579628136), fxr(3433986423),
	fxr(18446744070275565193), fxr(2579628136),
	fxr(3697395348), fxr(2185408821),
	fxr(18446744071524142795), fxr(3697395348),
	fxr(1069135926), fxr(4159770720),
	fxr(18446744069549780896), fxr(1069135926),
	fxr(4052703044), fxr(1422090755),
	fxr(18446744072287460861), fxr(4052703044),
	fxr(1860123788), fxr(3871263820),
	fxr(18446744069838287796), fxr(1860123788),
	fxr(3199998822), fxr(2864742853),
	fxr(18446744070844808763), fxr(3199998822),
	fxr(237061769), fxr(4288419964),
	fxr(18446744069421131652), fxr(237061769),
	fxr(4276788480), fxr(394745962),
	fxr(18446744073314805654), fxr(4276788480),
	fxr(2745018589), fxr(3303273682),
	fxr(18446744070406277934), fxr(2745018589),
	fxr(3800174601), fxr(2001353810),
	fxr(18446744071708197806), fxr(3800174601),
	fxr(1271958380), fxr(4102300081),
	fxr(18446744069607251535), fxr(1271958380),
	fxr(4117600071), fxr(1221521071),
	fxr(18446744072488030545), fxr(4117600071),
	fxr(2047837100), fxr(3775328765),
	fxr(18446744069934222851), fxr(2047837100),
	fxr(3336710553), fxr(2704275644),
	fxr(18446744071005275972), fxr(3336710553),
	fxr(447199012), fxr(4271622305),
	fxr(18446744069437929311), fxr(447199012),
	fxr(4217502704), fxr(812043729),
	fxr(18446744072897507887), fxr(4217502704),
	fxr(2408023134), fxr(3556426389),
	fxr(18446744070153125227), fxr(2408023134),
	fxr(3585708745), fxr(2364198992),
	fxr(18446744071345352624), fxr(3585708745),
	fxr(863737830), fxr(4207220108),
	fxr(18446744069502331508), fxr(863737830),
	fxr(3978042699), fxr(1619234497),
	fxr(18446744072090317119), fxr(3978042699),
	fxr(1667929275), fxr(3957872662),
	fxr(18446744069751678954), fxr(1667929275),
	fxr(3055578014), fxr(3018308645),
	fxr(18446744070691242971), fxr(3055578014),
	fxr(26353424), fxr(4294886444),
	fxr(18446744069414665172), fxr(26353424),
	fxr(4294947083), fxr(13176774),
	fxr(18446744073696374842), fxr(4294947083),
	fxr(3027668821), fxr(3046303593),
	fxr(18446744070663248023), fxr(3027668821),
	fxr(3962971170), fxr(1655778843),
	fxr(18446744072053772773), fxr(3962971170),
	fxr(1631431340), fxr(3973056236),
	fxr(18446744069736495380), fxr(1631431340),
	fxr(4209850218), fxr(850826195),
	fxr(18446744072858725421), fxr(4209850218),
	fxr(2375188665), fxr(3578438609),
	fxr(18446744070131113007), fxr(2375188665),
	fxr(3563797363), fxr(2397100839),
	fxr(18446744071312450777), fxr(3563797363),
	fxr(824979024), fxr(4214991540),
	fxr(18446744069494560076), fxr(824979024),
	fxr(4272974189), fxr(434091755),
	fxr(18446744073275459861), fxr(4272974189),
	fxr(2714499801), fxr(3328398249),
	fxr(18446744070381153367), fxr(2714499801),
	fxr(3781593674), fxr(2036244917),
	fxr(18446744071673306699), fxr(3781593674),
	fxr(1234147941), fxr(4113833119),
	fxr(18446744069595718497), fxr(1234147941),
	fxr(4106183088), fxr(1259366714),
	fxr(18446744072450184902), fxr(4106183088),
	fxr(2013003163), fxr(3794016650),
	fxr(18446744069915534966), fxr(2013003163),
	fxr(3311679735), fxr(2734871369),
	fxr(18446744070974680247), fxr(3311679735),
	fxr(407865107), fxr(4275557289),
	fxr(18446744069433994327), fxr(407865107),
	fxr(4289127078), fxr(223903967),
	fxr(18446744073485647649), fxr(4289127078),
	fxr(2874546829), fxr(3191194855),
	fxr(18446744070518356761), fxr(2874546829),
	fxr(3876952381), fxr(1848238164),
	fxr(18446744071861313452), fxr(3876952381),
	fxr(1434517580), fxr(4048321058),
	fxr(18446744069661230558), fxr(1434517580),
	fxr(4163031206), fxr(1056368897),
	fxr(18446744072653182719), fxr(4163031206),
	fxr(2196741986), fxr(3690673207),
	fxr(18446744070018878409), fxr(2196741986),
	fxr(3441884449), fxr(2569080674),
	fxr(18446744071140470942), fxr(3441884449),
	fxr(617165468), fxr(4250394200),
	fxr(18446744069459157416), fxr(617165468),
	fxr(4246527332), fxr(643233779),
	fxr(18446744073066317837), fxr(4246527332),
	fxr(2547913306), fxr(3457583240),
	fxr(18446744070251968376), fxr(2547913306),
	fxr(3677124776), fxr(2219346178),
	fxr(18446744071490205438), fxr(3677124776),
	fxr(1030805132), fxr(4169434596),
	fxr(18446744069540117020), fxr(1030805132),
	fxr(4039442815), fxr(1459330606),
	fxr(18446744072250221010), fxr(4039442815),
	fxr(1824414839), fxr(3888219974),
	fxr(18446744069821331642), fxr(1824414839),
	fxr(3173496894), fxr(2894073520),
	fxr(18446744070815478096), fxr(3173496894),
	fxr(197582163), fxr(4290420185),
	fxr(18446744069419131431), fxr(197582163),
	fxr(4293330151), fxr(118576083),
	fxr(18446744073590975533), fxr(4293330151),
	fxr(2951996911), fxr(3119688816),
	fxr(18446744070589862800), fxr(2951996911),
	fxr(3921142750), fxr(1752536335),
	fxr(18446744071957015281), fxr(3921142750),
	fxr(1533436302), fxr(4011896955),
	fxr(18446744069697654661), fxr(1533436302),
	fxr(4187701970), fxr(953884839),
	fxr(18446744072755666777), fxr(4187701970),
	fxr(2286654023), fxr(3635650898),
	fxr(18446744070073900718), fxr(2286654023),
	fxr(3503896214), fxr(2483838842),
	fxr(18446744071225712774), fxr(3503896214),
	fxr(721289485), fxr(4233968062),
	fxr(18446744069475583554), fxr(721289485),
	fxr(4261034104), fxr(538825051),
	fxr(18446744073170726565), fxr(4261034104),
	fxr(2631999263), fxr(3394012957),
	fxr(18446744070315538659), fxr(2631999263),
	fxr(3730482776), fxr(2128436593),
	fxr(18446744071581115023), fxr(3730482776),
	fxr(1132817720), fxr(4142881616),
	fxr(18446744069566670000), fxr(1132817720),
	fxr(4074039976), fxr(1359758194),
	fxr(18446744072349793422), fxr(4074039976),
	fxr(1919287054), fxr(3842275534),
	fxr(18446744069867276082), fxr(1919287054),
	fxr(3243565216), fxr(2815320366),
	fxr(18446744070894231250), fxr(3243565216),
	fxr(302814837), fxr(4284279082),
	fxr(18446744069425272534), fxr(302814837),
	fxr(4282340394), fxr(329096979),
	fxr(18446744073380454637), fxr(4282340394),
	fxr(2795365227), fxr(3260778637),
	fxr(18446744070448772979), fxr(2795365227),
	fxr(3830426680), fxr(1942826684),
	fxr(18446744071766724932), fxr(3830426680),
	fxr(1334734758), fxr(4082306603),
	fxr(18446744069627245013), fxr(1334734758),
	fxr(4135852789), fxr(1158216639),
	fxr(18446744072551334977), fxr(4135852789),
	fxr(2105506713), fxr(3743472393),
	fxr(18446744069966079223), fxr(2105506713),
	fxr(3377799422), fxr(2652774988),
	fxr(18446744071056776628), fxr(3377799422),
	fxr(512669694), fxr(4264260060),
	fxr(18446744069445291556), fxr(512669694),
	fxr(4229462610), fxr(747255046),
	fxr(18446744072962296570), fxr(4229462610),
	fxr(2462292582), fxr(3519070803),
	fxr(18446744070190480813), fxr(2462292582),
	fxr(3621551813), fxr(2308918911),
	fxr(18446744071400632705), fxr(3621551813),
	fxr(928171626), fxr(4193476065),
	fxr(18446744069516075551), fxr(928171626),
	fxr(4002412444), fxr(1558023973),
	fxr(18446744072151527643), fxr(4002412444),
	fxr(1728443664), fxr(3931822297),
	fxr(18446744069777729319), fxr(1728443664),
	fxr(3101516976), fxr(2971083391),
	fxr(18446744070738468225), fxr(3101516976),
	fxr(92230472), fxr(4293976900),
	fxr(18446744069415574716), fxr(92230472),
	fxr(4294461982), fxr(65881389),
	fxr(18446744073643670227), fxr(4294461982),
	fxr(2990058012), fxr(3083228366),
	fxr(18446744070626323250), fxr(2990058012),
	fxr(3942353812), fxr(1704285919),
	fxr(18446744072005265697), fxr(3942353812),
	fxr(1582552984), fxr(3992777245),
	fxr(18446744069716774371), fxr(1582552984),
	fxr(4199092278), fxr(902423468),
	fxr(18446744072807128148), fxr(4199092278),
	fxr(2331096871), fxr(3607316378),
	fxr(18446744070102235238), fxr(2331096871),
	fxr(3534112901), fxr(2440653617),
	fxr(18446744071268897999), fxr(3534112901),
	fxr(773192474), fxr(4224797921),
	fxr(18446744069484753695), fxr(773192474),
	fxr(4267325469), fxr(486495035),
	fxr(18446744073223056581), fxr(4267325469),
	fxr(2673450838), fxr(3361458715),
	fxr(18446744070348092901), fxr(2673450838),
	fxr(3756321069), fxr(2082497563),
	fxr(18446744071627054053), fxr(3756321069),
	fxr(1183571952), fxr(4128668249),
	fxr(18446744069580883367), fxr(1183571952),
	fxr(4090419533), fxr(1309661069),
	fxr(18446744072399890547), fxr(4090419533),
	fxr(1966293167), fxr(3818433613),
	fxr(18446744069891118003), fxr(1966293167),
	fxr(3277869293), fxr(2775304843),
	fxr(18446744070934246773), fxr(3277869293),
	fxr(355366730), fxr(4280240479),
	fxr(18446744069429311137), fxr(355366730),
	fxr(4286056468), fxr(276521294),
	fxr(18446744073433030322), fxr(4286056468),
	fxr(2835169511), fxr(3226229675),
	fxr(18446744070483321941), fxr(2835169511),
	fxr(3853979728), fxr(1895675165),
	fxr(18446744071813876451), fxr(3853979728),
	fxr(1384730436), fxr(4065619964),
	fxr(18446744069643931652), fxr(1384730436),
	fxr(4149754467), fxr(1107376152),
	fxr(18446744072602175464), fxr(4149754467),
	fxr(2151286337), fxr(3717352710),
	fxr(18446744069992198906), fxr(2151286337),
	fxr(3410098710), fxr(2611124444),
	fxr(18446744071098427172), fxr(3410098710),
	fxr(564960121), fxr(4257647723),
	fxr(18446744069451903893), fxr(564960121),
	fxr(4238314108), fxr(695296767),
	fxr(18446744073014254849), fxr(4238314108),
	fxr(2505291588), fxr(3488589706),
	fxr(18446744070220961910), fxr(2505291588),
	fxr(3649613104), fxr(2264303042),
	fxr(18446744071445248574), fxr(3649613104),
	fxr(979562138), fxr(4181770210),
	fxr(18446744069527781406), fxr(979562138),
	fxr(4021230421), fxr(1508790899),
	fxr(18446744072200760717), fxr(4021230421),
	fxr(1776563023), fxr(3910315575),
	fxr(18446744069799236041), fxr(1776563023),
	fxr(3137743202), fxr(2932799290),
	fxr(18446744070776752326), fxr(3137743202),
	fxr(144917230), fxr(4292521761),
	fxr(18446744069417029855), fxr(144917230),
	fxr(4291551760), fxr(171252920),
	fxr(18446744073538298696), fxr(4291551760),
	fxr(2913491250), fxr(3155679453),
	fxr(18446744070553872163), fxr(2913491250),
	fxr(3899341179), fxr(1800522825),
	fxr(18446744071909028791), fxr(3899341179),
	fxr(1484088690), fxr(4030412489),
	fxr(18446744069679139127), fxr(1484088690),
	fxr(4175681009), fxr(1005202558),
	fxr(18446744072704349058), fxr(4175681009),
	fxr(2241866812), fxr(3663437903),
	fxr(18446744070046113713), fxr(2241866812),
	fxr(3473151854), fxr(2526650010),
	fxr(18446744071182901606), fxr(3473151854),
	fxr(669277872), fxr(4242500584),
	fxr(18446744069467051032), fxr(669277872),
	fxr(4254101044), fxr(591073921),
	fxr(18446744073118477695), fxr(4254101044),
	fxr(2590151318), fxr(3426056074),
	fxr(18446744070283495542), fxr(2590151318),
	fxr(3704082687), fxr(2174055087),
	fxr(18446744071535496529), fxr(3704082687),
	fxr(1081892891), fxr(4156471081),
	fxr(18446744069553080535), fxr(1081892891),
	fxr(4057046884), fxr(1409650544),
	fxr(18446744072299901072), fxr(4057046884),
	fxr(1871991904), fxr(3865538822),
	fxr(18446744069844012794), fxr(1871991904),
	fxr(3208772670), fxr(2854911913),
	fxr(18446744070854639703), fxr(3208772670),
	fxr(250217341), fxr(4287672487),
	fxr(18446744069421879129), fxr(250217341),
	fxr(4277979416), fxr(381623102),
	fxr(18446744073327928514), fxr(4277979416),
	fxr(2755139971), fxr(3294836538),
	fxr(18446744070414715078), fxr(2755139971),
	fxr(3806296784), fxr(1989685620),
	fxr(18446744071719865996), fxr(3806296784),
	fxr(1284538073), fxr(4098378461),
	fxr(18446744069611173155), fxr(1284538073),
	fxr(4121328267), fxr(1208882703),
	fxr(18446744072500668913), fxr(4121328267),
	fxr(2059410008), fxr(3769028322),
	fxr(18446744069940523294), fxr(2059410008),
	fxr(3344991450), fxr(2694026034),
	fxr(18446744071015525582), fxr(3344991450),
	fxr(460302060), fxr(4270230215),
	fxr(18446744069439321401), fxr(460302060),
	fxr(4219974170), fxr(799100792),
	fxr(18446744072910450824), fxr(4219974170),
	fxr(2418922764), fxr(3549021941),
	fxr(18446744070160529675), fxr(2418922764),
	fxr(3592945130), fxr(2353187066),
	fxr(18446744071356364550), fxr(3592945130),
	fxr(876641334), fxr(4204550397),
	fxr(18446744069505001219), fxr(876641334),
	fxr(3982991719), fxr(1607022414),
	fxr(18446744072102529202), fxr(3982991719),
	fxr(1680064008), fxr(3952736900),
	fxr(18446744069756814716), fxr(1680064008),
	fxr(3064823674), fxr(3008920059),
	fxr(18446744070700631557), fxr(3064823674),
	fxr(39529826), fxr(4294785381),
	fxr(18446744069414766235), fxr(39529826),
	fxr(4294785381), fxr(39529826),
	fxr(18446744073670021790), fxr(4294785381),
	fxr(3008920059), fxr(3064823674),
	fxr(18446744070644727942), fxr(3008920059),
	fxr(3952736900), fxr(1680064008),
	fxr(18446744072029487608), fxr(3952736900),
	fxr(1607022414), fxr(3982991719),
	fxr(18446744069726559897), fxr(1607022414),
	fxr(4204550397), fxr(876641334),
	fxr(18446744072832910282), fxr(4204550397),
	fxr(2353187066), fxr(3592945130),
	fxr(18446744070116606486), fxr(2353187066),
	fxr(3549021941), fxr(2418922764),
	fxr(18446744071290628852), fxr(3549021941),
	fxr(799100792), fxr(4219974170),
	fxr(18446744069489577446), fxr(799100792),
	fxr(4270230215), fxr(460302060),
	fxr(18446744073249249556), fxr(4270230215),
	fxr(2694026034), fxr(3344991450),
	fxr(18446744070364560166), fxr(2694026034),
	fxr(3769028322), fxr(2059410008),
	fxr(18446744071650141608), fxr(3769028322),
	fxr(1208882703), fxr(4121328267),
	fxr(18446744069588223349), fxr(1208882703),
	fxr(4098378461), fxr(1284538073),
	fxr(18446744072425013543), fxr(4098378461),
	fxr(1989685620), fxr(3806296784),
	fxr(18446744069903254832), fxr(1989685620),
	fxr(3294836538), fxr(2755139971),
	fxr(18446744070954411645), fxr(3294836538),
	fxr(381623102), fxr(4277979416),
	fxr(18446744069431572200), fxr(381623102),
	fxr(4287672487), fxr(250217341),
	fxr(18446744073459334275), fxr(4287672487),
	fxr(2854911913), fxr(3208772670),
	fxr(18446744070500778946), fxr(2854911913),
	fxr(3865538822), fxr(1871991904),
	fxr(18446744071837559712), fxr(3865538822),
	fxr(1409650544), fxr(4057046884),
	fxr(18446744069652504732), fxr(1409650544),
	fxr(4156471081), fxr(1081892891),
	fxr(18446744072627658725), fxr(4156471081),
	fxr(2174055087), fxr(3704082687),
	fxr(18446744070005468929), fxr(2174055087),
	fxr(3426056074), fxr(2590151318),
	fxr(18446744071119400298), fxr(3426056074),
	fxr(591073921), fxr(4254101044),
	fxr(18446744069455450572), fxr(591073921),
	fxr(4242500584), fxr(669277872),
	fxr(18446744073040273744), fxr(4242500584),
	fxr(2526650010), fxr(3473151854),
	fxr(18446744070236399762), fxr(2526650010),
	fxr(3663437903), fxr(2241866812),
	fxr(18446744071467684804), fxr(3663437903),
	fxr(1005202558), fxr(4175681009),
	fxr(18446744069533870607), fxr(1005202558),
	fxr(4030412489), fxr(1484088690),
	fxr(18446744072225462926), fxr(4030412489),
	fxr(1800522825), fxr(3899341179),
	fxr(18446744069810210437), fxr(1800522825),
	fxr(3155679453), fxr(2913491250),
	fxr(18446744070796060366), fxr(3155679453),
	fxr(171252920), fxr(4291551760),
	fxr(18446744069417999856), fxr(171252920),
	fxr(4292521761), fxr(144917230),
	fxr(18446744073564634386), fxr(4292521761),
	fxr(2932799290), fxr(3137743202),
	fxr(18446744070571808414), fxr(2932799290),
	fxr(3910315575), fxr(1776563023),
	fxr(18446744071932988593), fxr(3910315575),
	fxr(1508790899), fxr(4021230421),
	fxr(18446744069688321195), fxr(1508790899),
	fxr(4181770210), fxr(979562138),
	fxr(18446744072729989478), fxr(4181770210),
	fxr(2264303042), fxr(3649613104),
	fxr(18446744070059938512), fxr(2264303042),
	fxr(3488589706), fxr(2505291588),
	fxr(18446744071204260028), fxr(3488589706),
	fxr(695296767), fxr(4238314108),
	fxr(18446744069471237508), fxr(695296767),
	fxr(4257647723), fxr(564960121),
	fxr(18446744073144591495), fxr(4257647723),
	fxr(2611124444), fxr(3410098710),
	fxr(18446744070299452906), fxr(2611124444),
	fxr(3717352710), fxr(2151286337),
	fxr(18446744071558265279), fxr(3717352710),
	fxr(1107376152), fxr(4149754467),
	fxr(18446744069559797149), fxr(1107376152),
	fxr(4065619964), fxr(1384730436),
	fxr(18446744072324821180), fxr(4065619964),
	fxr(1895675165), fxr(3853979728),
	fxr(18446744069855571888), fxr(1895675165),
	fxr(3226229675), fxr(2835169511),
	fxr(18446744070874382105), fxr(3226229675),
	fxr(276521294), fxr(4286056468),
	fxr(18446744069423495148), fxr(276521294),
	fxr(4280240479), fxr(355366730),
	fxr(18446744073354184886), fxr(4280240479),
	fxr(2775304843), fxr(3277869293),
	fxr(18446744070431682323), fxr(2775304843),
	fxr(3818433613), fxr(1966293167),
	fxr(18446744071743258449), fxr(3818433613),
	fxr(1309661069), fxr(4090419533),
	fxr(18446744069619132083), fxr(1309661069),
	fxr(4128668249), fxr(1183571952),
	fxr(18446744072525979664), fxr(4128668249),
	fxr(2082497563), fxr(3756321069),
	fxr(18446744069953230547), fxr(2082497563),
	fxr(3361458715), fxr(2673450838),
	fxr(18446744071036100778), fxr(3361458715),
	fxr(486495035), fxr(4267325469),
	fxr(18446744069442226147), fxr(486495035),
	fxr(4224797921), fxr(773192474),
	fxr(18446744072936359142), fxr(4224797921),
	fxr(2440653617), fxr(3534112901),
	fxr(18446744070175438715), fxr(2440653617),
	fxr(3607316378), fxr(2331096871),
	fxr(18446744071378454745), fxr(3607316378),
	fxr(902423468), fxr(4199092278),
	fxr(18446744069510459338), fxr(902423468),
	fxr(3992777245), fxr(1582552984),
	fxr(18446744072126998632), fxr(3992777245),
	fxr(1704285919), fxr(3942353812),
	fxr(18446744069767197804), fxr(1704285919),
	fxr(3083228366), fxr(2990058012),
	fxr(18446744070719493604), fxr(3083228366),
	fxr(65881389), fxr(4294461982),
	fxr(18446744069415089634), fxr(65881389),
	fxr(4293976900), fxr(92230472),
	fxr(18446744073617321144), fxr(4293976900),
	fxr(2971083391), fxr(3101516976),
	fxr(18446744070608034640), fxr(2971083391),
	fxr(3931822297), fxr(1728443664),
	fxr(18446744071981107952), fxr(3931822297),
	fxr(1558023973), fxr(4002412444),
	fxr(18446744069707139172), fxr(1558023973),
	fxr(4193476065), fxr(928171626),
	fxr(18446744072781379990), fxr(4193476065),
	fxr(2308918911), fxr(3621551813),
	fxr(18446744070087999803), fxr(2308918911),
	fxr(3519070803), fxr(2462292582),
	fxr(18446744071247259034), fxr(3519070803),
	fxr(747255046), fxr(4229462610),
	fxr(18446744069480089006), fxr(747255046),
	fxr(4264260060), fxr(512669694),
	fxr(18446744073196881922), fxr(4264260060),
	fxr(2652774988), fxr(3377799422),
	fxr(18446744070331752194), fxr(2652774988),
	fxr(3743472393), fxr(2105506713),
	fxr(18446744071604044903), fxr(3743472393),
	fxr(1158216639), fxr(4135852789),
	fxr(18446744069573698827), fxr(1158216639),
	fxr(4082306603), fxr(1334734758),
	fxr(18446744072374816858), fxr(4082306603),
	fxr(1942826684), fxr(3830426680),
	fxr(18446744069879124936), fxr(1942826684),
	fxr(3260778637), fxr(2795365227),
	fxr(18446744070914186389), fxr(3260778637),
	fxr(329096979), fxr(4282340394),
	fxr(18446744069427211222), fxr(329096979),
	fxr(4284279082), fxr(302814837),
	fxr(18446744073406736779), fxr(4284279082),
	fxr(2815320366), fxr(3243565216),
	fxr(18446744070465986400), fxr(2815320366),
	fxr(3842275534), fxr(1919287054),
	fxr(18446744071790264562), fxr(3842275534),
	fxr(1359758194), fxr(4074039976),
	fxr(18446744069635511640), fxr(1359758194),
	fxr(4142881616), fxr(1132817720),
	fxr(18446744072576733896), fxr(4142881616),
	fxr(2128436593), fxr(3730482776),
	fxr(18446744069979068840), fxr(2128436593),
	fxr(3394012957), fxr(2631999263),
	fxr(18446744071077552353), fxr(3394012957),
	fxr(538825051), fxr(4261034104),
	fxr(18446744069448517512), fxr(538825051),
	fxr(4233968062), fxr(721289485),
	fxr(18446744072988262131), fxr(4233968062),
	fxr(2483838842), fxr(3503896214),
	fxr(18446744070205655402), fxr(2483838842),
	fxr(3635650898), fxr(2286654023),
	fxr(18446744071422897593), fxr(3635650898),
	fxr(953884839), fxr(4187701970),
	fxr(18446744069521849646), fxr(953884839),
	fxr(4011896955), fxr(1533436302),
	fxr(18446744072176115314), fxr(4011896955),
	fxr(1752536335), fxr(3921142750),
	fxr(18446744069788408866), fxr(1752536335),
	fxr(3119688816), fxr(2951996911),
	fxr(18446744070757554705), fxr(3119688816),
	fxr(118576083), fxr(4293330151),
	fxr(18446744069416221465), fxr(118576083),
	fxr(4290420185), fxr(197582163),
	fxr(18446744073511969453), fxr(4290420185),
	fxr(2894073520), fxr(3173496894),
	fxr(18446744070536054722), fxr(2894073520),
	fxr(3888219974), fxr(1824414839),
	fxr(18446744071885136777), fxr(3888219974),
	fxr(1459330606), fxr(4039442815),
	fxr(18446744069670108801), fxr(1459330606),
	fxr(4169434596), fxr(1030805132),
	fxr(18446744072678746484), fxr(4169434596),
	fxr(2219346178), fxr(3677124776),
	fxr(18446744070032426840), fxr(2219346178),
	fxr(3457583240), fxr(2547913306),
	fxr(18446744071161638310), fxr(3457583240),
	fxr(643233779), fxr(4246527332),
	fxr(18446744069463024284), fxr(643233779),
	fxr(4250394200), fxr(617165468),
	fxr(18446744073092386148), fxr(4250394200),
	fxr(2569080674), fxr(3441884449),
	fxr(18446744070267667167), fxr(2569080674),
	fxr(3690673207), fxr(2196741986),
	fxr(18446744071512809630), fxr(3690673207),
	fxr(1056368897), fxr(4163031206),
	fxr(18446744069546520410), fxr(1056368897),
	fxr(4048321058), fxr(1434517580),
	fxr(18446744072275034036), fxr(4048321058),
	fxr(1848238164), fxr(3876952381),
	fxr(18446744069832599235), fxr(1848238164),
	fxr(3191194855), fxr(2874546829),
	fxr(18446744070835004787), fxr(3191194855),
	fxr(223903967), fxr(4289127078),
	fxr(18446744069420424538), fxr(223903967),
	fxr(4275557289), fxr(407865107),
	fxr(18446744073301686509), fxr(4275557289),
	fxr(2734871369), fxr(3311679735),
	fxr(18446744070397871881), fxr(2734871369),
	fxr(3794016650), fxr(2013003163),
	fxr(18446744071696548453), fxr(3794016650),
	fxr(1259366714), fxr(4106183088),
	fxr(18446744069603368528), fxr(1259366714),
	fxr(4113833119), fxr(1234147941),
	fxr(18446744072475403675), fxr(4113833119),
	fxr(2036244917), fxr(3781593674),
	fxr(18446744069927957942), fxr(2036244917),
	fxr(3328398249), fxr(2714499801),
	fxr(18446744070995051815), fxr(3328398249),
	fxr(434091755), fxr(4272974189),
	fxr(18446744069436577427), fxr(434091755),
	fxr(4214991540), fxr(824979024),
	fxr(18446744072884572592), fxr(4214991540),
	fxr(2397100839), fxr(3563797363),
	fxr(18446744070145754253), fxr(2397100839),
	fxr(3578438609), fxr(2375188665),
	fxr(18446744071334362951), fxr(3578438609),
	fxr(850826195), fxr(4209850218),
	fxr(18446744069499701398), fxr(850826195),
	fxr(3973056236), fxr(1631431340),
	fxr(18446744072078120276), fxr(3973056236),
	fxr(1655778843), fxr(3962971170),
	fxr(18446744069746580446), fxr(1655778843),
	fxr(3046303593), fxr(3027668821),
	fxr(18446744070681882795), fxr(3046303593),
	fxr(13176774), fxr(4294947083),
	fxr(18446744069414604533), fxr(13176774),
}

// Convert a (real) vector to its FFT representation.
func vect_FFT(logn uint, f []fxr) {
	hn := 1 << (logn - 1)
	t := hn
	for lm := uint(1); lm < logn; lm++ {
		m := 1 << lm
		ht := t >> 1
		j0 := 0
		hm := m >> 1
		for i := 0; i < hm; i++ {
			s_re := gm_tab[((m+i)<<1)+0]
			s_im := gm_tab[((m+i)<<1)+1]
			for j := j0; j < j0+ht; j++ {
				x_re := f[j]
				x_im := f[j+hn]
				y_re := f[j+ht]
				y_im := f[j+ht+hn]
				y_re, y_im = fxc_mul(s_re, s_im, y_re, y_im)
				z1_re, z1_im := fxc_add(x_re, x_im, y_re, y_im)
				f[j] = z1_re
				f[j+hn] = z1_im
				z2_re, z2_im := fxc_sub(x_re, x_im, y_re, y_im)
				f[j+ht] = z2_re
				f[j+ht+hn] = z2_im
			}
			j0 += t
		}
		t = ht
	}
}

// Convert back from FFT representation into a real vector.
func vect_iFFT(logn uint, f []fxr) {
	hn := 1 << (logn - 1)
	ht := 1
	for lm := logn - 1; lm > 0; lm-- {
		m := 1 << lm
		t := ht << 1
		j0 := 0
		hm := m >> 1
		for i := 0; i < hm; i++ {
			s_re := gm_tab[((m+i)<<1)+0]
			s_im := fxr_neg(gm_tab[((m+i)<<1)+1])
			for j := j0; j < j0+ht; j++ {
				x_re := f[j]
				x_im := f[j+hn]
				y_re := f[j+ht]
				y_im := f[j+ht+hn]
				z1_re, z1_im := fxc_add(x_re, x_im, y_re, y_im)
				z1_re, z1_im = fxc_half(z1_re, z1_im)
				f[j] = z1_re
				f[j+hn] = z1_im
				z2_re, z2_im := fxc_sub(x_re, x_im, y_re, y_im)
				z2_re, z2_im = fxc_half(z2_re, z2_im)
				z2_re, z2_im = fxc_mul(s_re, s_im, z2_re, z2_im)
				f[j+ht] = z2_re
				f[j+ht+hn] = z2_im
			}
			j0 += t
		}
		ht = t
	}
}

// Set a vector d to the value of the small polynomial f.
func vect_set(logn uint, d []fxr, f []int8) {
	n := 1 << logn
	for i := 0; i < n; i++ {
		d[i] = fxr_of(int32(f[i]))
	}
}

// Add vector b to vector a. This works in both real and FFT representations.
// Vectors a and b MUST NOT overlap.
func vect_add(logn uint, a []fxr, b []fxr) {
	n := 1 << logn
	for i := 0; i < n; i++ {
		a[i] = fxr_add(a[i], b[i])
	}
}

// Multiply vector a by the real constant c. This works in both real
// and FFT representations.
func vect_mul_realconst(logn uint, a []fxr, c fxr) {
	n := 1 << logn
	for i := 0; i < n; i++ {
		a[i] = fxr_mul(a[i], c)
	}
}

// Multiply a vector by 2^e. This works in both real and FFT representations.
func vect_mul2e(logn uint, a []fxr, e uint32) {
	n := 1 << logn
	for i := 0; i < n; i++ {
		a[i] = fxr_mul2e(a[i], e)
	}
}

// Multiply vector a by vector b. The vectors must be in FFT representation.
// Vectors a and b MUST NOT overlap.
func vect_mul_fft(logn uint, a []fxr, b []fxr) {
	hn := 1 << (logn - 1)
	for i := 0; i < hn; i++ {
		z_re, z_im := fxc_mul(a[i], a[i+hn], b[i], b[i+hn])
		a[i] = z_re
		a[i+hn] = z_im
	}
}

// Convert a vector into its adjoint (in FFT representation).
func vect_adj_fft(logn uint, a []fxr) {
	hn := 1 << (logn - 1)
	n := 1 << logn
	for i := hn; i < n; i++ {
		a[i] = fxr_neg(a[i])
	}
}

// Multiply vector a by self-adjoint vector b. The vectors must be in FFT
// representation. Since the FFT representation of a self-adjoint vector
// contains only real numbers, the second half of b contains only zeros and
// is not accessed by this function. Vectors a and b MUST NOT overlap.
func vect_mul_selfadj_fft(logn uint, a []fxr, b []fxr) {
	hn := 1 << (logn - 1)
	for i := 0; i < hn; i++ {
		x := b[i]
		a[i] = fxr_mul(a[i], x)
		a[i+hn] = fxr_mul(a[i+hn], x)
	}
}

// Divide vector a by self-adjoint vector b. The vectors must be in FFT
// representation. Since the FFT representation of an auto-adjoint vector
// contains only real numbers, the second half of b contains only zeros and
// is not accessed by this function. Vectors a and b MUST NOT overlap.
func vect_div_selfadj_fft(logn uint, a []fxr, b []fxr) {
	hn := 1 << (logn - 1)
	for i := 0; i < hn; i++ {
		// Note that we perform two separate divisions, instead of one
		// inversion and two multiplications, because the latter would lose
		// too much precision.
		x := b[i]
		a[i] = fxr_div(a[i], x)
		a[i+hn] = fxr_div(a[i+hn], x)
	}
}

// Compute d = a*adj(a) + b*adj(b). Polynomials are in FFT representation.
// Since d is self-adjoint, only its first half is set; the second half
// is _implicitly_ zero (this function does not access the second half of d).
// Vectors a, b and d MUST NOT overlap.
func vect_norm_fft(logn uint, d []fxr, a []fxr, b []fxr) {
	hn := 1 << (logn - 1)
	for i := 0; i < hn; i++ {
		d[i] = fxr_add(
			fxr_add(fxr_sqr(a[i]), fxr_sqr(a[i+hn])),
			fxr_add(fxr_sqr(b[i]), fxr_sqr(b[i+hn])))
	}
}

// Compute d = (2^e)/(a*adj(a) + b*adj(b)). Polynomials are in FFT
// representation. Since d is self-adjoint, only its first half is set; the
// second half is _implicitly_ zero (this function does not access the
// second half of d). Vectors a, b and d MUST NOT overlap.
func vect_invnorm_fft(logn uint, d []fxr, a []fxr, b []fxr, e uint32) {
	hn := 1 << (logn - 1)
	fe := fxr_of(int32(1) << e)
	for i := 0; i < hn; i++ {
		z := fxr_add(
			fxr_add(fxr_sqr(a[i]), fxr_sqr(a[i+hn])),
			fxr_add(fxr_sqr(b[i]), fxr_sqr(b[i+hn])))
		d[i] = fxr_div(fe, z)
	}
}
